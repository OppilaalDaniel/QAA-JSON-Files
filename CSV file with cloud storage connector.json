{"blocks":[{"id":"A87F5625-9E8C-46BB-9C78-5F71627E610B","type":"StartBlock","disabled":false,"name":"Start","displayName":"Start","comment":"","childId":"15AE087B-072C-4E53-9FE9-3E63E9E03554","inputs":[{"id":"run_mode","value":"manual","type":"select","structure":{}}],"settings":[],"collapsed":[{"name":"loop","isCollapsed":false}],"x":188.45732499441732,"y":-262.9400228121201,"logo":null},{"id":"343B2A59-1041-4EE3-8194-320485DAFEBD","type":"CheckFileExistsBlock","disabled":false,"name":"checkIfFileExists3","displayName":"{$.filename} - Check If File Exists 3 on Microsoft OneDrive","comment":"","childId":"CA4BD490-DE10-487D-AFE2-6A8CA2754905","inputs":[{"id":"datasourcetype","value":"Microsoft OneDrive","type":"select","structure":[]},{"id":"path","value":"{$.filename}","type":"string","structure":[]}],"settings":[{"id":"blendr_on_error","value":"stop","type":"select","structure":[]},{"id":"datasource","value":"8948f6c0-2ced-11ed-98bc-3f20a68d3c40","type":"select","structure":[]}],"collapsed":[{"name":"loop","isCollapsed":false}],"x":188.45732499441732,"y":1617.05997718788},{"id":"CA4BD490-DE10-487D-AFE2-6A8CA2754905","type":"IfElseBlock","disabled":false,"name":"condition3","displayName":"Condition 3","comment":"","childId":"5963F59A-9ABE-49EA-802B-1AACE670BF68","inputs":[{"id":"conditions","value":{"mode":"all","conditions":[{"input1":"{$.checkIfFileExists3}","input2":"true","operator":"="}]},"type":"custom","structure":[]}],"settings":[],"collapsed":[{"name":"yes","isCollapsed":false},{"name":"no","isCollapsed":false}],"x":-435.9309761173949,"y":304.02192308294224,"childTrueId":"236A6A42-E37D-48B1-A066-BAB6A0E5812D","childFalseId":null},{"id":"5963F59A-9ABE-49EA-802B-1AACE670BF68","type":"CreateFileBlock","disabled":false,"name":"createFile4","displayName":"{$.filename} - Create File 4 on Microsoft OneDrive","comment":"","childId":"CF177BA2-D33D-4328-99DC-B3A43FBD50CC","inputs":[{"id":"datasourcetype","value":"Microsoft OneDrive","type":"select","structure":[]},{"id":"path","value":"{$.filename}","type":"string","structure":[]}],"settings":[{"id":"blendr_on_error","value":"stop","type":"select","structure":[]},{"id":"datasource","value":"8948f6c0-2ced-11ed-98bc-3f20a68d3c40","type":"select","structure":[]}],"collapsed":[{"name":"loop","isCollapsed":false}],"x":671.9427433765712,"y":457.7831162406524},{"id":"2131F9EE-DD40-4FF6-B9C0-9E7BAA8D5807","type":"CloseFileBlock","disabled":false,"name":"saveAndCloseFile4","displayName":"{$.filename} - Save And Close File 4 on Microsoft OneDrive","comment":"","childId":"75E97576-3B39-4925-9F85-FB5BD2507ECD","inputs":[{"id":"file","value":"5963F59A-9ABE-49EA-802B-1AACE670BF68","type":"select","displayValue":"Create File 4 on Microsoft OneDrive ({$.filename})","structure":[]}],"settings":[{"id":"blendr_on_error","value":"stop","type":"select","structure":[]}],"collapsed":[{"name":"loop","isCollapsed":false}],"x":-73.5444726247664,"y":1081.061328318362},{"id":"236A6A42-E37D-48B1-A066-BAB6A0E5812D","type":"DeleteFileBlock","disabled":false,"name":"deleteFile3","displayName":"{$.filename} - Delete File 3 on Microsoft OneDrive","comment":"","childId":null,"inputs":[{"id":"datasourcetype","value":"Microsoft OneDrive","type":"select","structure":[]},{"id":"path","value":"{$.filename}","type":"string","structure":[]}],"settings":[{"id":"blendr_on_error","value":"stop","type":"select","structure":[]},{"id":"datasource","value":"8948f6c0-2ced-11ed-98bc-3f20a68d3c40","type":"select","structure":[]}],"collapsed":[{"name":"loop","isCollapsed":false}],"x":-463.9559455236049,"y":310.24969406210005},{"id":"46B5E608-145C-4AB7-AF76-F243F1A44F1E","type":"WriteLineToFileBlock","disabled":false,"name":"writeLineToFile4","displayName":"{$.filename} - Write Line To File 4 on Microsoft OneDrive","comment":"","childId":null,"inputs":[{"id":"file","value":"5963F59A-9ABE-49EA-802B-1AACE670BF68","type":"select","displayValue":"Create File 4 on Microsoft OneDrive ({$.filename})","structure":[]},{"id":"data","value":"{$.GetStraightTableData.item}","type":"string","structure":[]},{"id":"mode","value":"csv","type":"select","displayValue":"CSV","structure":[]},{"id":"delimiter","value":",","type":"string","structure":[]},{"id":"file_encoding","value":"","type":"string","structure":[]},{"id":"csv_columns","value":"{$.Columnheaders}{linebreak}","type":"string","structure":[]},{"id":"csv_headers","value":"yes","type":"select","structure":[]}],"settings":[{"id":"blendr_on_error","value":"stop","type":"select","structure":[]}],"collapsed":[{"name":"loop","isCollapsed":false}],"x":308.4573249944173,"y":717.0599771878799},{"id":"617ACAB6-217B-42C9-8541-FC50F02D7BCC","type":"VariableBlock","disabled":false,"name":"filename","displayName":"Variable - filename","comment":"","childId":"343B2A59-1041-4EE3-8194-320485DAFEBD","inputs":[],"settings":[],"collapsed":[{"name":"loop","isCollapsed":false}],"x":188.45732499441732,"y":1377.05997718788,"variableGuid":"552C23C3-791D-4882-BB28-2C699E58E959","operations":[{"id":"set_value","key":"8F21515A-B808-4783-A614-7D93313D4655","name":"Set value of { variable }","value":"Test/CSV File.csv"}]},{"id":"CF177BA2-D33D-4328-99DC-B3A43FBD50CC","type":"SnippetBlock","disabled":false,"name":"GetStraightTableData","displayName":"Qlik Cloud Services - Get Straight Table Data","comment":"","childId":"2131F9EE-DD40-4FF6-B9C0-9E7BAA8D5807","inputs":[{"id":"702aa990-e7d6-11ea-9155-5563fc8a0200","value":"75153d87-3c35-487c-8340-59fd09a980ad","type":"string","displayValue":"Tips and Tricks (75153d87-3c35-487c-8340-59fd09a980ad)","structure":[]},{"id":"5295ea90-1fa5-11eb-8b61-a1195c91b158","value":"9a79a664-4bab-46e4-b5a1-93be4b7a48bd","type":"string","displayValue":"KPI","structure":[]},{"id":"702b4760-e7d6-11ea-bd24-c3ad734592ce","value":"JrPj","type":"string","displayValue":"Mail - JrPj - table - row 6 col 12","structure":[]}],"settings":[{"id":"blendr_on_error","value":"stop","type":"select","structure":[]}],"collapsed":[{"name":"loop","isCollapsed":false}],"x":188.45732499441732,"y":497.0599771878799,"loopBlockId":"46B5E608-145C-4AB7-AF76-F243F1A44F1E","datasourcetype_guid":"61a87510-c7a3-11ea-95da-0fb0c241e75c","snippet_guid":"70247640-e7d6-11ea-b140-a1d938943465"},{"id":"4A84707A-832C-4D89-885B-F33F7CD0C009","type":"EndpointBlock","disabled":false,"name":"SendMail","displayName":"Mail - Send Mail","comment":"","childId":null,"inputs":[{"id":"442845a0-cd00-11eb-9aa5-b966a68573b7","value":"oppilaale@gain-insights.com","type":"string","structure":[]},{"id":"543f08c0-cd00-11eb-b9c6-af8e23cc2439","value":null,"type":"string","structure":[]},{"id":"5cbdb1d0-cd00-11eb-8afd-ddd4ecc002ac","value":null,"type":"string","structure":[]},{"id":"72cad1e0-cd00-11eb-aa1b-3f42c1d22e38","value":"CSV File created using Cloud Storage Connector","type":"string","structure":[]},{"id":"79af8c50-cd24-11eb-a019-dfdc9a7f7317","value":"8ca918e0-cd24-11eb-a713-779c5b59e5f7","type":"select","displayValue":"text","structure":[]},{"id":"7d225d00-cd00-11eb-8493-055760e8b45a","value":"Hi,\n\nPFA, the CSV file created and stored using a Cloud Storage Connector (OneDrive).\n\nThanks,\nOppilaal.","type":"longtext","structure":[]},{"id":"bb841f10-3341-11ec-b9a3-9d6de0bb7866","value":[{"value":"{$.openFile}"}],"type":"custom","structure":[]}],"settings":[{"id":"datasource","value":"4fc8c120-6c8c-11ec-b179-8b913145c497","type":"select","structure":[]},{"id":"blendr_on_error","value":"stop","type":"select","structure":[]}],"collapsed":[{"name":"loop","isCollapsed":false}],"x":-405,"y":615,"datasourcetype_guid":"05407a80-ccfd-11eb-b098-7140f6ac27f4","endpoint_guid":"84a79bf0-ccff-11eb-a508-7d415a725ea7","endpoint_role":"create"},{"id":"75E97576-3B39-4925-9F85-FB5BD2507ECD","type":"OpenFileBlock","disabled":false,"name":"openFile","displayName":"{$.filename} - Open File on Microsoft OneDrive","comment":"","childId":"4A84707A-832C-4D89-885B-F33F7CD0C009","inputs":[{"id":"datasourcetype","value":"Microsoft OneDrive","type":"select","displayValue":"Microsoft OneDrive","structure":[]},{"id":"path","value":"{$.filename}","type":"string","structure":[]}],"settings":[{"id":"blendr_on_error","value":"stop","type":"select","structure":[]},{"id":"datasource","value":"8948f6c0-2ced-11ed-98bc-3f20a68d3c40","type":"select","structure":[]}],"collapsed":[{"name":"loop","isCollapsed":false}],"x":188.45732499441732,"y":2397.0599771878797},{"id":"15AE087B-072C-4E53-9FE9-3E63E9E03554","type":"VariableBlock","disabled":false,"name":"ColumnProcess","displayName":"Variable - ColumnProcess","comment":"Variable to configure Loop 2 to create list of Column Names","childId":"E08C27E6-2373-4091-A993-04EB87E8C3CC","inputs":[],"settings":[],"collapsed":[{"name":"loop","isCollapsed":true}],"x":796.4768259769417,"y":-1.856788392073148,"variableGuid":"5901AC46-360A-4DE8-9899-5C0B1C0A041D","operations":[{"id":"set_value","key":"55D66AB5-7B26-48E0-B08B-3900B9CD7603","name":"Set value of { variable }","value":"0"}]},{"id":"E08C27E6-2373-4091-A993-04EB87E8C3CC","type":"VariableBlock","disabled":false,"name":"Columncount","displayName":"Variable - Columncount","comment":"Initialize variable for number of Columns","childId":"3B3546A4-FDFF-43FC-B459-C6A4A25BD8C5","inputs":[],"settings":[],"collapsed":[{"name":"loop","isCollapsed":true}],"x":-306.2627135490428,"y":322.2349574475476,"variableGuid":"37FA7D66-61F2-4671-BC9A-99877C42216D","operations":[{"id":"set_value","key":"9F963C5F-2881-428D-A607-F656A034B555","name":"Set value of { variable }","value":"1"}]},{"id":"3B3546A4-FDFF-43FC-B459-C6A4A25BD8C5","type":"VariableBlock","disabled":false,"name":"Columnheaders","displayName":"Variable - Columnheaders","comment":"","childId":"CC39357E-2CE7-44E1-87E0-E0DDDE2CBA4F","inputs":[],"settings":[],"collapsed":[{"name":"loop","isCollapsed":false}],"x":-639.1258720477629,"y":707.0435362586178,"variableGuid":"3ACDC1DC-F6A0-433A-84E6-54D6ED28559D","operations":[{"id":"empty","key":"EACC2681-25D3-4B98-8BBE-E8B215E631AC","name":"Empty { variable }"}]},{"id":"CC39357E-2CE7-44E1-87E0-E0DDDE2CBA4F","type":"SnippetBlock","disabled":false,"name":"GetStraightTableData2","displayName":"Qlik Cloud Services - Get Straight Table Data 2","comment":"Get table data from Qlik Sense object","childId":"DE789644-7E84-4672-9C58-079C84BD72A7","inputs":[{"id":"702aa990-e7d6-11ea-9155-5563fc8a0200","value":"75153d87-3c35-487c-8340-59fd09a980ad","type":"string","displayValue":"Tips and Tricks (75153d87-3c35-487c-8340-59fd09a980ad)","structure":[]},{"id":"5295ea90-1fa5-11eb-8b61-a1195c91b158","value":"9a79a664-4bab-46e4-b5a1-93be4b7a48bd","type":"string","displayValue":"KPI","structure":[]},{"id":"702b4760-e7d6-11ea-bd24-c3ad734592ce","value":"JrPj","type":"string","displayValue":"Mail - JrPj - table - row 6 col 12","structure":[]}],"settings":[{"id":"blendr_on_error","value":"stop","type":"select","structure":[]}],"collapsed":[{"name":"loop","isCollapsed":false}],"x":-246.2054798015954,"y":495.2462002209654,"loopBlockId":"BB25593D-B77B-4FE3-AFBB-79B5C6643552","datasourcetype_guid":"61a87510-c7a3-11ea-95da-0fb0c241e75c","snippet_guid":"70247640-e7d6-11ea-b140-a1d938943465"},{"id":"DE789644-7E84-4672-9C58-079C84BD72A7","type":"VariableBlock","disabled":false,"name":"Columnheaders","displayName":"Variable - Columnheaders","comment":"Stores the column header in html format","childId":"617ACAB6-217B-42C9-8541-FC50F02D7BCC","inputs":[],"settings":[],"collapsed":[{"name":"loop","isCollapsed":false}],"x":-246.2054798015954,"y":1295.2462002209654,"variableGuid":"3ACDC1DC-F6A0-433A-84E6-54D6ED28559D","operations":[{"id":"set_value","key":"CD9F3B15-B7D0-4728-BDBB-0DBAA278C29D","name":"Set value of { variable }","value":"{rtrim: {$.Columnheaders}, ','}"}]},{"id":"BB25593D-B77B-4FE3-AFBB-79B5C6643552","type":"ForEachBlock","disabled":false,"name":"loop3","displayName":"Loop 3","comment":"Loop over items ONCE to build list of column names","childId":null,"inputs":[{"id":"input","value":"{$.GetStraightTableData2.item}","type":"string","structure":[]}],"settings":[],"collapsed":[{"name":"loop","isCollapsed":false}],"x":-6.205479801595402,"y":555.2462002209654,"loopBlockId":"775E404A-4AC6-46F1-AEF0-A0928E31F5C9"},{"id":"775E404A-4AC6-46F1-AEF0-A0928E31F5C9","type":"IfElseBlock","disabled":false,"name":"condition","displayName":"Condition","comment":"Ensure loop occurs for only number of columns","childId":null,"inputs":[{"id":"conditions","value":{"mode":"all","conditions":[{"input1":"{$.Columncount}","input2":"{$.ColumnProcess}","operator":"<="}]},"type":"custom","structure":[]}],"settings":[],"collapsed":[{"name":"yes","isCollapsed":false},{"name":"no","isCollapsed":false}],"x":305,"y":1615,"childTrueId":null,"childFalseId":"107F9975-D0D4-4F1B-A5F2-CD6D87D617D7"},{"id":"107F9975-D0D4-4F1B-A5F2-CD6D87D617D7","type":"VariableBlock","disabled":false,"name":"Columncount","displayName":"Variable - Columncount","comment":"Count items in Table data  ie Number of Columns","childId":"16A83477-8680-4B7D-9F18-C25D38107865","inputs":[],"settings":[],"collapsed":[{"name":"loop","isCollapsed":true}],"x":433,"y":1861,"variableGuid":"37FA7D66-61F2-4671-BC9A-99877C42216D","operations":[{"id":"set_value","key":"9F963C5F-2881-428D-A607-F656A034B555","name":"Set value of { variable }","value":"{count: {$.GetStraightTableData2.item}}"}]},{"id":"16A83477-8680-4B7D-9F18-C25D38107865","type":"VariableBlock","disabled":false,"name":"Columnheaders","displayName":"Variable - Columnheaders","comment":"Stores the column header in html format","childId":"72475896-8D75-4A3D-855D-EF7E2DBA8EEA","inputs":[],"settings":[],"collapsed":[{"name":"loop","isCollapsed":false}],"x":-172.75860621336437,"y":1286.9516662589067,"variableGuid":"3ACDC1DC-F6A0-433A-84E6-54D6ED28559D","operations":[{"id":"append","key":"F15933F5-4CD9-4D36-8E24-96F415F48647","name":"Append to { variable }","value":"{$.loop3.index},"}]},{"id":"72475896-8D75-4A3D-855D-EF7E2DBA8EEA","type":"VariableBlock","disabled":false,"name":"ColumnProcess","displayName":"Variable - ColumnProcess","comment":"Variable to configure Loop 2 to create list of Column Names","childId":null,"inputs":[],"settings":[],"collapsed":[{"name":"loop","isCollapsed":true}],"x":173.7372864509572,"y":1522.2349574475477,"variableGuid":"5901AC46-360A-4DE8-9899-5C0B1C0A041D","operations":[{"id":"add","key":"A3C3D05B-A99A-4EDB-A048-83723FF794B4","name":"Add to { variable }","value":"1"}]}],"variables":[{"guid":"2746758C-6DCB-4A29-B24F-D30998DE45D3","name":"List1","type":"list"},{"guid":"686D75B2-452E-401A-9879-87AB032188A7","name":"List2","type":"list"},{"guid":"7C7D4702-B25C-4C3C-A5E2-48FABC4BC695","name":"status","type":"object"},{"guid":"99C4A485-E3E2-463C-B811-F09A8B59FB1D","name":"LoadScript","type":"string"},{"guid":"D3236295-62B6-4E0B-8689-73FD1630F0B3","name":"finalPath","type":"string"},{"guid":"E1F75326-9ED6-4717-9DED-89BB3D9208E0","name":"CSV","type":"list"},{"guid":"552C23C3-791D-4882-BB28-2C699E58E959","name":"filename","type":"string"},{"guid":"78E98BF4-56ED-41AB-9DEB-DA9670E313BC","name":"templatebase64","type":"string"},{"guid":"C29B1B54-7EB7-44E9-9A9F-31E0E9965B53","name":"list","type":"object"},{"guid":"02590F25-2043-484A-A618-E10CE90B2112","name":"headerr","type":"string"},{"guid":"3ACDC1DC-F6A0-433A-84E6-54D6ED28559D","name":"Columnheaders","type":"string"},{"guid":"5901AC46-360A-4DE8-9899-5C0B1C0A041D","name":"ColumnProcess","type":"number"},{"guid":"37FA7D66-61F2-4671-BC9A-99877C42216D","name":"Columncount","type":"number"}]}